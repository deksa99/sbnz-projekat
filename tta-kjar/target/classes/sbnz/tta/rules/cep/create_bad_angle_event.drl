package sbnz.tta.rules.cep;

import com.tta.app.model.events.HitEvent;
import com.tta.app.model.events.BadAngleEvent;
import com.tta.app.model.enums.TrainingLevel;
import com.tta.app.model.training.Training;

// TODO add template

rule "Bad angle event for EASY | delta = 10"

    when
    	$tr: Training(level == TrainingLevel.EASY, $id: id)
    	$lastHit: HitEvent( trainingId == $id && (angleDelta >= 10.0 || <= -10.0) && badAngleProcessed == false, $delta: angleDelta)
    then
        modify($lastHit) {
            setBadAngleProcessed(true);
        }

        BadAngleEvent badAngleEvent = new BadAngleEvent($id);
        badAngleEvent.setAngle($delta);
        insert(badAngleEvent);
        System.out.println("Kreiran dogadjaj za los ugao za EASY nivo");
end

rule "Bad angle event for MEDIUM | delta = 10"

    when
    	$tr: Training(level == TrainingLevel.MEDIUM, $id: id)
    	$lastHit: HitEvent( trainingId == $id && (angleDelta >= 5.0 || <= -5.0) && badAngleProcessed == false, $delta: angleDelta)
    then
        modify($lastHit) {
            setBadAngleProcessed(true);
        }

        BadAngleEvent badAngleEvent = new BadAngleEvent($id);
        badAngleEvent.setAngle($delta);
        insert(badAngleEvent);
        System.out.println("Kreiran dogadjaj za los ugao za MEDIUM nivo");
end

rule "Bad angle event for HARD | delta = 10"

    when
    	$tr: Training(level == TrainingLevel.HARD, $id: id)
    	$lastHit: HitEvent( trainingId == $id && (angleDelta >= 2.0 || <= -2.0) && badAngleProcessed == false, $delta: angleDelta)
    then
        modify($lastHit) {
            setBadAngleProcessed(true);
        }

        BadAngleEvent badAngleEvent = new BadAngleEvent($id);
        badAngleEvent.setAngle($delta);
        insert(badAngleEvent);
        System.out.println("Kreiran dogadjaj za los ugao za BEGINNER nivo");
end